\documentclass[11pt]{article}
\usepackage{geometry}                
\geometry{a4paper}                   

\usepackage[latin1]{inputenc}

\usepackage[colorlinks, linkcolor=blue, citecolor=blue, filecolor=blue, urlcolor=blue]{hyperref}
\usepackage{hyperref}
\usepackage[nottoc,notlot,notlof]{tocbibind}

\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage[comma]{natbib}
\usepackage{amssymb, amsmath}
\renewcommand{\vec}[1]{\mathbf{#1}}

\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\title{Epidemiology \& Immunization}
\author{Julius Siebenaller, Jannes Hühnerbein, Benjamin Gundersen, Nicolas Antunes Morgado}
\date{November 2019} 

\begin{document}



\section{Description of the Model}

% Considerations regarding the disease and the modelled time-horizon:
% Assume an outbreak of a severe disease with the possibility to receive a vaccination that works immediately when not yet infected. 

The general assumptions of our model are as follows:
\begin{itemize}
\item{The infectious disease is modelled as a time-homogeneous Markov chain with a finite state space according to an SIVR-process with 'vaccinated', respectively 'recovered' representing the final or absorbing states with permanent immunity. The population is assumed to stay constant.}
\item{Agents are assumed to be rational utility-maximisers endowed with complete information about their immediate neighborhood. They decide in each time-step whether or not to update their vaccination decision and hence if they will get vaccinated employing a mixed strategy.}
\item{When facing the vaccination decision, each agent samples the health status of its direct neighborhood and deduces the probability of infection during the next epoch from the amount of infected neighbors.}
\item{The time-horizon of an agent is bounded, in the sense that only a certain amount of time-steps is considered in the calculation of expected utility to be maximized through the vaccination-decision.}
\item{Agents have a group affiliation to either be skeptical (group: 'skepticals') or trust (group: 'trusters') that vaccines are safe. The group membership of an agent determines the subjective costs they assign to vaccination, while the costs of infection are assumed to be equal between groups.}
\item{The population structure is modelled as a scale-free network, relying on a Barabási-Albert model. We assume the two groups to represent scale-free networks on their own. These two networks are then combined assuming that closeness in a group is larger than between groups.}
\end{itemize}
Concerning the epidemiological part of our model, the spread of the disease in the population follows an SIVR-process. Thus, the population is divided into (1) susceptible (2) infectious (3) recovered and (4) vaccinated subpopulations. The subpopulations are the same for the two belief-groups of skepticals and trusters. Susceptible agents can transition to the infectious state, \(S \rightarrow{} I \), by at least one contagious interaction with an infected neighbor; individual interactions have probability \(\beta\) of infecting a susceptible agent, while the total probability of infection \(\lambda_{k}(t)\) depends on the number of infected neighbors. I On the other hand, if the agent decides to vaccinate it transitions according to the rule \(S \rightarrow{} V \) with probability \(p_{vacc}(t)\) at time-step \(t\). Infectious agents recover by the probability \(\gamma_{k}\), \(I \rightarrow{} R\). Recovered, respectively vaccinated, agents stay in their respective state which can be regarded as isomorphic with the exception of how these states are reached. Both recovered and vaccinated agents are assumed to become fully immunized. A constant population is assumed in a way that no entries, via birth, or exits, via death, are taken into account.\footnote{A more detailed version of the SIVR-model can be found in XYZ or ABC.}\\
With regards to the agent's decision and infection propagation processes, the work of SHIM ET AL motivated our modelling choices and is partly derived from their analysis. Still, the approach developed in the present work deviates from it in several respects.\\
First off, a discrete-time rather than continuous time Markov process is used to describe disease dynamics. This choice is justified both on simplicity grounds and because at least part of the mechanism leading to contracting a disease, such as meeting other agents, can be considered inherently discrete events. Secondly, SHIM ET AL employs time dependent population balances to derive steady state solutions to an endemic disease (measles), while the decision to vaccinate newborns by their parents has long-term effects. This leads to the explicit modeling of birth-death rates in the population balances and the use of infinitely long time horizons when calculating the agent's expected utilities. The large time scales associated with the decision to vaccinate also give credibility to the assumption of complete knowledge of population-level information, such as the global steady state incidence of measles which is likely available to parents who decide to vaccinate their children. Finally, this game-theoretic setting is sufficient for the existence of a Nash equilibrium which the authors derive for the diverging vaccination policies of different social groups.\\
In opposition, in the present work we attempted to describe an infectious disease with short time scales of propagation and recovery, with characteristics of an unexpected outbreak for which a vaccine could be readily available for any individual independently of it's age.\footnote{An empirical example satisfying our definition would be the H1N1 avian flu pandemic of 2009.}. Under these conditions we do not expect to reach an endemic steady state but a mixture of immunized agents, either due to recovery or to vaccination. Moreover, the effective consequences of the decision to vaccinate are assumed to be limited in time, and so agents should only have access to information from their local social links and prior beliefs to evaluate the costs involved. This implies that no Nash equilibrium can arise at the population level, but rather a set of heterogeneous decisions under non-equilibrium conditions. All in all, these are the reasons why we chose to omit birth-death terms in population balances, as well as to limit the time-horizon and knowledge of the infection prevalence to each agent's neighborhood in the determination of their expected utility, using a network structure for the population rather than a well mixed approximation.
%Restriction to the assumption of complete information, but can on the other hand justify the Markov process rule

\subsection{Epidemic dynamics}

The evolution of the $\mathit{k}^{th}$ agent state is summarised in the stochastic matrix \(\mathbf{Q}_k(t)\) and the health-state probability vector \(\mathbf{x}_k(t)\). The disease-specific parameters and transmission rates are outlined below:

\begin{equation}\label{eq:1}
	 \mathbf{x}_k(t+1) = \mathbf{Q}_k(t) \cdot \mathbf{x}_k(t)
\end{equation}

and:

\begin{equation}\label{eq:2}
	 \mathbf{Q}_k(t) = 
	 \left (\begin{array}{cccc} p_{k}(S\rightarrow{}S)&p_{k}(I\rightarrow{}S)&p_{k}(R\rightarrow{}S)&p_{k}(V\rightarrow{}S) \\
	 	p_{k}(S\rightarrow{}I)&p_{k}(I\rightarrow{}I)&p_{k}(R\rightarrow{}I)&p_{k}(V\rightarrow{}I) \\
		p_{k}(S\rightarrow{}R)&p_{k}(I\rightarrow{}R)&p_{k}(R\rightarrow{}R)&p_{k}(V\rightarrow{}R) \\
		p_{k}(S\rightarrow{}V)&p_{k}(I\rightarrow{}V)&p_{k}(R\rightarrow{}V)&p_{k}(V\rightarrow{}V) \\
	  \end{array} \right)
\end{equation}

In particular: 

\begin{equation}\label{eq:3}			% time-dependency of Q_{k}
	 \mathbf{Q}_k(t) = 
	 \left (\begin{array}{cccc} 1-\lambda_{k}(t)&0&0&0 \\
	 	\lambda_{k}(t)&1-\gamma_{k}&0&0 \\
		0&\gamma_{k}&1&0 \\
		0&0&0&1 \\
	  \end{array} \right)
\end{equation}

For infected agents, the probability of transitioning to a recovered state or remaining infected does not depend on the spread of the disease nor can it be influenced by a decision to vaccinate. Given the absorbing quality of recovered and vaccinated states, this means that only susceptible individuals are active decision makers in the population. For purely susceptible agents, the health probability column vector:

\begin{equation}\label{eq:4}
	\mathbf{x}_k(t)^{'}=\left(\begin{array}{cccc} 1-p_{vacc},&0,&0,&p_{vacc}  \end{array} \right),
\end{equation} 

represents their state at time \(t\) after the choice of vaccination strategy. 

% INITIAL STATES

As outlined above, \(\beta\) represents the probability for an agent of getting infected by a single interaction. This parameter is assumed to be disease-specific, and thus constant in value and independent of the agent's state. The probability of infection \(\lambda_{k}(t)\) for an agent interacting with it's entire neighbourhood results:

\begin{equation}\label{eq:5}
	\lambda_{k}(t)=1-(1-\beta)^{n_{k}(t)},
\end{equation}

with the integer \(n_{k}(t)\) representing the instantaneous number of infected neighbours of agent \(k\) at time \(t\). %, which takes the following form: xyz % age-specific 
%sampling the neighbourhood at \(t=0\)

\subsection{Agent policy}

A susceptible agent, being a rational utility-maximizer, faces the vaccination decision by solving the optimization problem:

\begin{equation}\label{eq:6}
	\max_{{p_{vacc}}} \; U_k(\mathbf{x}_k(t), T)
\end{equation}

where \(T\) represents the time-horizon of the agent. The expected utility function takes the subsequent form, following the Bellman equation for a discrete-time Markov process:

% reference for Bellmann equation
\begin{equation}\label{eq:7}
	\begin{split}
		U_k(\mathbf{x}_k(t), T) = \sum_{t'=t}^{t + T} \frac{  \mathbf{f}_k(t') \cdot \mathbf{x}_k(t')}{(1+r)^{(t'-t)}}
	\end{split}
\end{equation}

where \(\mathbf{f}_k(t)\) is the payoff row vector of agent \(k\) with: 

% Payoff-vectors
\begin{equation}\label{eq:8}
	\mathbf{f}_k(t' = t)=\left( \begin{array}{cccc}0&0&0&-C_{v,k} \end{array} \right)
	% other suggestions for transpose T
\end{equation}

and:

\begin{equation}\label{eq:9}
\mathbf{f}_k(t' > t)=\left( \begin{array}{cccc} 0&-C_{i,k}&0&0 \end{array} \right)
\end{equation}

represent the immediate vaccination payoffs, respectively the payoffs per time step as a result of infection.  
The different components of the perceived cost, among others the market price of the vaccine and it's expected side-effects conditional on the agent's beliefs, are included in \(C_{v,k}\). Besides, \(C_{i,k}\) captures the costs of infection, including medical treatment expenditures, absence from work or reduced personal well-being. Finally, agents discount the payoffs of future events using a discount rate \(r\).\\
Even though the actual infection probability  \(\lambda_{k}(t)\) is time dependent due to fluctuations in the incidence of the disease in the population, it is assumed to lie beyond the capabilities of any individual to simulate the entire social network for an accurate prediction of its evolution. Instead, each susceptible agent makes a point estimation \(\hat{\lambda}_{k}\) and assumes it to be constant during the forward time-horizon \(T\). The latter hypothesis amounts to treating the infection dynamics as a stationary Markov chain at the agent level:

\begin{equation}\label{eq:10}
	 \mathbf{x}_k(t+1) = \hat{\mathbf{Q}}_k \cdot \mathbf{x}_k(t)
\end{equation}

with:

\begin{equation}\label{eq:11}
	 \hat{\mathbf{Q}}_k = 
	 \left (\begin{array}{cccc} 1-\hat{\lambda}_{k}&0&0&0 \\
	 	\hat{\lambda}_{k}&1-\gamma_{k}&0&0 \\
		0&\gamma_{k}&1&0 \\
		0&0&0&1 \\
	  \end{array} \right)
\end{equation}

Given that the evolution of a stationary Markov chain is independent of any absolute time reference, without loss of generality \eqref{eq:7} can be rewritten using $t = 0$. Employing \eqref{eq:8} and \eqref{eq:9}:

\begin{equation}\label{eq:12}
	U_k(\mathbf{x}_k(0), T) = \mathbf{f}_k(0) \cdot \mathbf{x}_k(0) + \sum_{t=1}^{T} {\mathbf{f}_k(t) \cdot   \left(\frac{ \hat{\mathbf{Q}}_k}{1+r}\right)^t \cdot \mathbf{x}_k(0) }
\end{equation}

In order to compute the power \({\hat{\mathbf{Q}}_k}^t\), the matrix can be diagonalized:

\begin{equation}\label{eq:13}
	\hat{\mathbf{Q}}_k=\hat{\mathbf{R}}_{k}\hat{\mathbf{\Lambda}}_{k}\hat{\mathbf{R}}^{-1}_{k}
\end{equation}

And we can rewrite \eqref{eq:12} as follows:

\begin{equation}\label{eq:14}
	U_k(\mathbf{x}_k(0), T)= \left[ \mathbf{f}_k(0) + \mathbf{f}_k(t) \cdot \hat{\mathbf{R}}_{k} \cdot \sum_{t=1}^{T} { \left(\frac{ \hat{\mathbf{\Lambda}}_{k}}{1+r}\right)^t \cdot \hat{\mathbf{R}}^{-1}_{k}} \right] \cdot \mathbf{x}_k(0)
\end{equation}

Finally, performing the required computations we obtain: 

\begin{equation}\label{eq:15}
	U_k(\mathbf{x}_k(0), T)=-p_{vacc} \cdot C_{v,k} - (1-p_{vacc}) \cdot C_{notv,k}
\end{equation}

where: 

\begin{equation}\label{eq:16}
	C_{notv,k}=C_{i,k} \cdot \left( \frac{\hat{\lambda}_{k}}{\gamma_{k}-\hat{\lambda}_{k}} \right) \cdot \left[\sum_{t = 1}^{T} \left(\frac{1-\hat{\lambda}_{k}}{1+r}\right)^t - \sum_{t = 1}^{T}\left(\frac{1-\gamma_k}{1+r}\right)^t\right]
\end{equation}

Equation \eqref{eq:16} is linear in \(p_{vacc}\), so it has only one global maximum which depends on the relative cost of each decision. In particular, the preferred strategies are the following:

\begin{equation}\label{eq:17}
	\begin{array}
	{@{}lr@{}}
        \multirow{p_{vacc}=0,} & \text{for }C_{v,k}>C_{notv,k} \\
        {p_{vacc}=1,} & \text{for }C_{notv,k}>C_{v,k} \\
        {p_{vacc}\in(0,1),} & \text{for }C_{v,k}=C_{notv,k} \\
    \end{array}
\end{equation}

Thus, agents follow a pure strategy for almost all values of \(C_{notv,k}\). It is clear from Equation\eqref{eq:17} that \textit{ceteris paribus} a different vaccination strategy will be chosen depending on an agent's beliefs, manifested through different relative values for \(C_{v,k}\) and \(C_{i,k}\). In particular, it is expected that individuals skeptical towards vaccines will preferentially decide not to vaccinate for a given \(\hat{\lambda}_{k}\) and \(T\), as they consider the costs to be higher than what individuals who believe in the effectiveness of vaccines do.

Ref.:
\cite{shim2012}



INITIAL SETUP
IN OUR CALCUALTIONS, WE USE THE PARAMETERS AS OUTLINED BELOW:
......

%-----------------------------------------------------------------------------------------------

--------------- \\

NETWORK \\
The hierarchical configuration model in STEGEHUIS ET AL provides an orientation for the model which is employed in this thesis. Adopting the two belief-groups, these are identified as sub-communities of the whole population. Each group is assumed to have a close intra-connection and a looser inter-connection. A small-world model is employed by formulating Watts-Strogatz networks (WATTS STROGATZ) for every group, which are then connected as outlined below. \\
Each community \(G\in{\{T,S\}}\) is a subset of the whole population \(N\), \(G\subset{N}\), with T representing 'trusters' and S representing 'skepticals'. Furthermore, 
\begin{equation}
\(g\colon \mathbb{N} \rightarrow{\{1,2\}}, 
\begin{align*}
g(i)\mapsto \left\{
\begin{array}{ll}	1, & i\textrm{ in group }T \\
	2, &  i\textrm{ in group }S \\
\end{array} \right\) 
\end{align*}
\end{equation}
indicates community-membership for an individual agent \(i\in{N}\).
The groups consist of a total of \(n_{G}\) members, according to \(n_{G}=\sum_{i\in{N}}p_{G}(i)=p_{G}(i)*n\). With \(n={\[\|N\|}\) being the number of nodes in the total population \(N\). Furthermore, \(p_{G}(i)\) defines the probabilistic group allocation for a node \(i\) to be assigned to group \(m\in{\{1,2\}}\), such that 
\begin{equation} 
\begin{align*}
\(p_{m}(i)=\left\{
\begin{array}{ll}	p_{1}, & i\textrm{ assigned to }T \\
	1-p_{1}=p_{2}, &  i\textrm{ assigned to  }S \\
\end{array} \right\)
\end{align*}
\end{equation}
and \(p_{G}(i)\) is independent of the individual agent \(i\). \\
The Watts-Strogatz graph for every group \(G\subset{N}\) is then built by taking into account \(k(i)\), the number of nearest neighbours of \(i\) that \(i\) is connected to in a ring topology. \\ 
Thereafter, the two graphs are combined by adding an additional fraction of the edges in both groups for any two members \(i,j\in{N},i\neq j,\) of different groups, requiring \(g(i)\neq g(j)\). The amount of edges \(e_{add}\) is the fraction according to 
\begin{equation}
e_{add}=a*e_{G}=a*\bigg(\sum_{i\in{T}}k(i) + \sum_{j\in{S}}k(j)\bigg),
\end{equation}
 with \(a\in{(0,1)}\), and \(e_{G}=(\sum_{i\in{T}}k(i) + \sum_{j\in{S}}k(j))\) the total of edges in both groups. Any two members of different groups are then randomly connected until the added connections reaches \(e_{add}\).  \\
%-----
NEIGHBOURS OF NEIGHBOURS: SHI ET AL (2017)



\section{Computational model}
All our calculations are carried out in Python. Especially numpy, matplotlib for plotting, networkx for the creation of our network. 


\end{document}  



 
