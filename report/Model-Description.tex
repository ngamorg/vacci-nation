\documentclass[11pt]{article}
\usepackage{geometry}                
\geometry{a4paper}                   

\usepackage[latin1]{inputenc}

\usepackage[colorlinks, linkcolor=blue, citecolor=blue, filecolor=blue, urlcolor=blue]{hyperref}
\usepackage{hyperref}
\usepackage[nottoc,notlot,notlof]{tocbibind}

\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage[comma]{natbib}
\usepackage{amssymb, amsmath}
\renewcommand{\vec}[1]{\mathbf{#1}}

\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\title{Epidemiology \& Immunization}
\author{Julius Siebenaller, Jannes Hühnerbein, Benjamin Gundersen, Nicolas Antunes Morgado}
\date{November 2019} 

\begin{document}



\section{Description of the Model}

% Considerations regarding the disease and the modelled time-horizon:
% Assume an outbreak of a severe disease with the possibility to receive a vaccination that works immediately when not yet infected. 

\subsection{Outline}

The general assumptions of our model are as follows:

\begin{itemize}
\item{The infectious disease evolution is modelled as a Markov chain with a finite state space, according to an SIVR-process with 'vaccinated' (respectively 'recovered') representing final or absorbing states, i.e. characterized by permanent immunity.}
\item{Agents are assumed to be rational utility-maximisers endowed with complete information about their immediate neighborhood, which they use to periodically update their vaccination (mixed) strategy.}
\item{When facing the decision to vaccinate, each agent samples the health status of its direct neighborhood and deduces his probability of infection during the next epoch, which is then employed to weight the relative costs of acquiring immunity vs. becoming infected in the future.}
\item{The time-horizon of an agent is bounded, in the sense that only a certain amount of time-steps is considered in the calculation of expected utility to be maximized.}
\item{Agent behavior is further influenced by his affiliation to a group attitude toward vaccine safety and effectiveness, which can be skeptical (group: 'skepticals') or trusting (group: 'trusters'). Operationally, the group membership of an agent determines the subjective costs they assign to vaccination, while the costs of infection are assumed to be equal between groups.}
\item{The population structure is modelled as a scale-free network, relying on a Barabási-Albert model. We assume the two groups to represent scale-free networks on their own; these two networks are then combined assuming that closeness in a group is larger than between groups.}
\end{itemize}

The work of SHIM ET AL motivates the aforementioned modelling choices with regards to the agent decision and infection propagation processes, and is partly derived from their analysis. Still, the approach developed in the present work deviates from it in several respects. First off, a discrete-time rather than continuous time Markov process is used to describe disease dynamics. This choice is justified both on simplicity grounds and because at least part of the dynamics -such as meeting other agents- can be considered inherently discrete events. Secondly, individual transition probabilities are based on the local instantaneous incidence of infection rather than the steady endemic distribution. The latter is justified by the fact that the present model employs a network structure for the population rather than a lumped, well mixed approximation. Moreover, the derivation of the vaccination policy does not aim to obtain the Nash equilibrium strategy for the population, but rather a locally optimal update rule under non-equilibrium conditions.
%Restriction to the assumption of complete information, but can on the other hand justify the Markov process rule

Concerning the epidemiological part of our model, the spread of the disease propagation follows an SIVR-process. Thus, the population is divided into (1) susceptible (2) infectious (3) recovered and (4) vaccinated subpopulations. Agents belonging to each subpopulation can in turn be affiliated to any of the two belief-groups of skepticals and trusters. Susceptible agents can transition to the infectious state, \(S \rightarrow{} I \), by at least one contagious interaction with an infected neighbor; individual interactions have probability \(\beta\) of infecting a susceptible agent while the overall probability of infection \(\lambda_{k}(t)\) depends on the instantaneous local incidence of the disease. On the other hand, if the agent decides to vaccinate it transitions according to the rule \(S \rightarrow{} V \) with probability \(p_{vacc}(t)\) at every time-step \(t\). Infectious agents recover with probability \(\gamma_{k}\), \(I \rightarrow{} R\). Recovered (respectively vaccinated) agents stay in their state which can be regarded as dynamically indistinguishable save for how these states are reached, as both recovered and vaccinated agents are assumed to become fully immunised.\footnote{A more detailed version of the SIVR-model can be found in XYZ or ABC.}

\subsection{Epidemic dynamics}

The evolution of the $\mathit{k}^{th}$ agent state is summarised in the stochastic matrix \(\mathbf{Q}_k(t)\) and the health-state probability vector \(\mathbf{x}_k(t)\). The disease-specific parameters and transmission rates are outlined below:
\begin{equation}\label{eq:1}
	 \mathbf{x}_k(t+1) = \mathbf{Q}_k(t) \cdot \mathbf{x}_k(t)
\end{equation}
and 
\begin{equation}\label{eq:2}
	 \mathbf{Q}_k(t) = 
	 \left (\begin{array}{cccc} p_{k}(S\rightarrow{}S)&p_{k}(I\rightarrow{}S)&p_{k}(R\rightarrow{}S)&p_{k}(V\rightarrow{}S) \\
	 	p_{k}(S\rightarrow{}I)&p_{k}(I\rightarrow{}I)&p_{k}(R\rightarrow{}I)&p_{k}(V\rightarrow{}I) \\
		p_{k}(S\rightarrow{}R)&p_{k}(I\rightarrow{}R)&p_{k}(R\rightarrow{}R)&p_{k}(V\rightarrow{}R) \\
		p_{k}(S\rightarrow{}V)&p_{k}(I\rightarrow{}V)&p_{k}(R\rightarrow{}V)&p_{k}(V\rightarrow{}V) \\
	  \end{array} \right)
\end{equation}

In particular: 

\begin{equation}\label{eq:3}			% time-dependency of Q_{k}
	 \mathbf{Q}_k(t) = 
	 \left (\begin{array}{cccc} 1-\lambda_{k}(t)&0&0&0 \\
	 	\lambda_{k}(t)&1-\gamma_{k}&0&0 \\
		0&\gamma_{k}&1&0 \\
		0&0&0&1 \\
	  \end{array} \right)
\end{equation}

For infected agents, the probability of transitioning to a recovered state or remaining infected does not depend on the spread of the disease nor can it be influenced by a decision to vaccinate. Given the absorbing quality of recovered and vaccinated states, this means that only susceptible individuals are active decision makers in the population. For purely susceptible agents, the health probability vector: 

\begin{equation}\label{eq:4}
	\mathbf{x}_k(t)^T=\left(\begin{array}{cccc} 1-p_{vacc},&0,&0,&p_{vacc}  \end{array} \right),
\end{equation} 

Represents their state at time \(t\) after the choice of vaccination probability. 

% INITIAL STATES

As outlined above, \(\beta\) represents the probability for an agent of getting infected by a single interaction. This parameter is assumed to be disease-specific, and thus constant in value and independent of the agent state. The probability of infection \(\lambda_{k}(t)\) for an agent interacting with it's entire neighbourhood results:

\begin{equation}\label{eq:5}
	\lambda_{k}(t)=1-(1-\beta)^{n_{k}(t)},
\end{equation}

with \(n_{k}(t)\) being the instantaneous amount of infected neighbours of agent \(k\) at time \(t\). %, which takes the following form: xyz % age-specific 
%sampling the neighbourhood at \(t=0\)

\subsection{Agent policy}

A susceptible agent, being a rational utility-maximizer, faces the vaccination decision by solving the optimization problem:
\begin{equation}\label{eq:6}
	\max_{{p_{vacc}}} \; U_k(\mathbf{x}_k(t), T)
\end{equation}
Where \(T\) represents the time-horizon of the agent. The expected utility function takes the subsequent form, following the Bellman equation for a discrete-time Markov process:

% reference for Bellmann equation
\begin{equation}\label{eq:7}
	\begin{split}
		U_k(\mathbf{x}_k(t), T) = \sum_{t'=t}^{t + T} \frac{\mathbf{x}_k(t') \cdot \mathbf{f}_k(t')}{(1+r)^{(t'-t)}}
	\end{split}
\end{equation}

Where \(\mathbf{f}_k(t)\) is the payoff vector of agent \(k\) with: 

% Payoff-vectors
\begin{equation}\label{eq:8}
	\mathbf{f}_k(t' = t)=\left( \begin{array}{cccc}0&0&0&-C_{v,k} \end{array} \right)^T
	% other suggestions for transpose T
\end{equation}

And:

\begin{equation}\label{eq:9}
\mathbf{f}_k(t' > t)=\left( \begin{array}{cccc} 0&-C_{i,k}&0&0 \end{array} \right)^T  
\end{equation}

Represent the immediate vaccination payoffs, respectively the payoffs per time step as a result of infection.  
The different components of the perceived cost, among others the market price of the vaccine and it's expected side-effects conditional on the agent's beliefs, are included in \(C_{v,k}\). Besides, \(C_{i,k}\) captures the costs of infection, including yet not limited to medical treatment expenditures, absence from work or reduced personal well-being. Finally, agents discount the payoffs of future events with a discount rate \(r\).\\
Even though the actual infection probability  \(\lambda_{k}(t)\) is time dependent due to fluctuations in the incidence of the disease in an agent's neighborhood, it is assumed to lie beyond the capabilities of any individual to simulate the entire social network which would be required for an accurate prediction of its evolution. Instead, the agent makes a point estimation \(\hat{\lambda}_{k}\) and assumes it to be constant during the forward time-horizon \(T\). The latter hypothesis amounts to treating the infection dynamics as a stationary Markov chain:

\begin{equation}\label{eq:10}
	 \mathbf{x}_k(t+1) = \hat{\mathbf{Q}}_k \cdot \mathbf{x}_k(t)
\end{equation}

With:

\begin{equation}\label{eq:11}
	 \hat{\mathbf{Q}}_k = 
	 \left (\begin{array}{cccc} 1-\hat{\lambda}_{k}&0&0&0 \\
	 	\hat{\lambda}_{k}&1-\gamma_{k}&0&0 \\
		0&\gamma_{k}&1&0 \\
		0&0&0&1 \\
	  \end{array} \right)
\end{equation}

Given that the evolution of a stationary Markov chain is independent of any absolute time reference, without loss of generality \eqref{eq:7} can be rewritten using $t = 0$. Employing \eqref{eq:8} and \eqref{eq:9}:

\begin{equation}\label{eq:12}
	U_k(\mathbf{x}_k(0), T)= \mathbf{x}_k(0) \cdot \mathbf{f}_k(0) + \sum_{t=1}^{T} {\mathbf{x}_k(0) \cdot \left(\frac{ \hat{\mathbf{Q}}_k}{1+r}\right)^t \cdot \mathbf{f}_k(t)}
\end{equation}

In order to compute the power \({\hat{\mathbf{Q}}_k}^t\), the matrix can be diagonalized:

\begin{equation}\label{eq:13}
	\hat{\mathbf{Q}}_k=\hat{\mathbf{R}}_{k}\hat{\mathbf{\Lambda}}_{k}\hat{\mathbf{R}}^{-1}_{k}
\end{equation}

And we can rewrite \eqref{eq:12} as follows:

\begin{equation}\label{eq:14}
	U_k(\mathbf{x}_k(0), T)= \mathbf{x}_k(0) \cdot \left[ \mathbf{f}_k(0) + \hat{\mathbf{R}}_{k} \cdot \sum_{t=1}^{T} { \left(\frac{ \hat{\mathbf{\Lambda}}_{k}}{1+r}\right)^t \cdot \hat{\mathbf{R}}^{-1}_{k} \cdot \mathbf{f}_k(t)} \right]
\end{equation}

Finally, performing the required computations we obtain: 

\begin{equation}\label{eq:15}
	U_k(\mathbf{x}_k(0), T)=-p_{vacc} \cdot C_{v,k} - (1-p_{vacc}) \cdot C_{\neg v,k}
\end{equation}

Where: 

\begin{equation}\label{eq:16}
	C_{\neg v,k}=C_{i,k} \cdot \left( \frac{\hat{\lambda}_{k}}{\gamma_{k}-\hat{\lambda}_{k}} \right) \cdot \left[\sum_{t = 1}^{T} \left(\frac{1-\hat{\lambda}_{k}}{1+r}\right)^t - \sum_{t = 1}^{T}\left(\frac{1-\gamma_k}{1+r}\right)^t\right]
\end{equation}

Equation \eqref{eq:16} is linear in \(p_{vacc}\), so it has only one global maximum which depends on the relative cost of each decision. In particular, the preferred strategies are the following:

\begin{equation}
	\begin{array}
	{@{}lr@{}}
        \multirow{p_{vacc}=0,} & \text{for }C_{v,k}>C_{\neg v,k} \\
        {p_{vacc}=1,} & \text{for }C_{\neg v,k}>C_{v,k} \\
        {p_{vacc}\in(0,1),} & \text{for }C_{v,k}=C_{\neg v,k} \\
    \end{array}
\end{equation}

Thus, the agent follows a pure strategy for almost all values of $C_{v,k}$, $C_{i,k}$, $\gamma_{k}$, $\hat{\lambda}_{k}$ and $T$. The threshold value for each agent differs depending on the local incidence of the disease, its group membership and time-horizon.

Ref.:
\cite{shim2012}

INITIAL SETUP
IN OUR CALCUALTIONS, WE USE THE PARAMETERS AS OUTLINED BELOW:
NETWORK

We decided on utilising 

\section{Computational model}

All our calculations are carried out in Python. Especially numpy, matplotlib for plotting, networkx for the creation of our network. 
\end{document}  



 
