\documentclass[11pt]{article}
\usepackage{geometry}                
\geometry{a4paper}                   

\usepackage[latin1]{inputenc}

\usepackage[colorlinks, linkcolor=blue, citecolor=blue, filecolor=blue, urlcolor=blue]{hyperref}
\usepackage{hyperref}
\usepackage[nottoc,notlot,notlof]{tocbibind}

\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage[comma]{natbib}
\usepackage{amssymb, amsmath}
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\title{Epidemiology \& Immunization}
\author{Julius Siebenaller, Jannes Huehnerbein, Benjamin Gundersen, Nicolas Antunes Morgado}
\date{November 2019} 

\begin{document}


\input{cover}

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% AGREEMENT FOR PUBLISHING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section*{Agreement for free-download}
\bigskip
\bigskip

\large We hereby agree to make our source code for this project freely available for download from the web pages of the Computational Social Science chair. Furthermore, we assure that all source code is written by ourselves and is not violating any copyright restrictions.

\begin{center}
\bigskip
\bigskip
\bigskip
\bigskip

\begin{tabular}{@{}p{8cm}@{}@{}p{8cm}@{}}

\begin{minipage}{8cm}
\large Nicolas Antunes Morgado
\end{minipage}

&
\begin{minipage}{8cm}
\large Benjamin Gundersen
\end{minipage}

\end{tabular}


\vspace{3\baselineskip}

\begin{tabular}{@{}p{8cm}@{}@{}p{8cm}@{}}

\begin{minipage}{8cm}
\large Julius Siebenaller
\end{minipage}
&
\begin{minipage}{8cm}
\large Jannes H\"uhnerbein
\end{minipage}
\end{tabular}

\end{center}


\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



% IMPORTANT
% you MUST include the ETH declaration of originality here; it is available for download on the course website or at http://www.ethz.ch/faculty/exams/plagiarism/index_EN; it can be printed as pdf and should be filled out in handwriting


%%%%%%%%%% Table of content %%%%%%%%%%%%%%%%%

\tableofcontents

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BEGIN REPORT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Abstract}
This paper describes our approach in simulating a fictional society and its vaccination behaviour throughout a single flu season (i.e. one winter).

The model that we want to investigate is split into two groups. One being very trusting towards vaccinations; the other having a more skeptical attitude.

The main emphasis is being placed on investigating different distributions, thus changing the composition of society in terms of what percentage is trusting or skeptical towards vaccinating and what effect this has on the flu outbreak.
\newpage


\section{Individual contributions}
\section{Introduction and Motivations}
Several times in human history epidemics have left areas and sometimes entire civilizations in total devastation. Only with the rise of modern medicine and especially widely available vaccines the development of large and complex societies of today was made possible.

The characteristics of the flu with its almost yearly outbreaks and frequent mutations - making a general vaccine impossible to develop - yield an interesting game theoretical problem.

In this project we want to investigate the behaviour of a fictional society by splitting it up into two different groups. One group trusts vaccines and hence needs very little incentive to get vaccinated ('trusters'). The other group is very skeptical towards the cost and return of vaccines and hence vaccinates much later, sometimes not at all ('skepticals').

With 'anti-vaxing' groups becoming more popular and diseases thought to be extinct reappearing even in Central Europe \footnote{e.g. a case of measles at ETH Zurich in summer 2019} this question is gaining relevance and hence we decided to take a closer look at it.


\clearpage
\section{Literature Review}
The following provides a small review of the literature concerning (1) the modelling of infectious diseases with respect to population structures and subpopulations as well as disease spreading. And (2) game theoretical analyses regarding the vaccination decisions of individuals. 

The work of \cite{kermack1927} is pivotal in the field of epidemiology, particularly concerning the spread of an infectious diseases in a population. Susceptible persons get infected based on the transmission rate of the disease and the size of the infectious subpopulation. They finally recover or die from the disease and hence join and stay in the recovered pool. This and subsequent compartmental models are commonly referred to as SIR-models of infectious diseases. 
As outlined in \cite{earn2008}, respectively in \cite{dadlani2013} or \cite{sun2016}, there exist various adaptations of the SIR-compartmental-model to either allow for different subpopulations, or to modify the disease process.\footnote{The case of severe acute respiratory syndrome (SARS) serves as an example to model the infectious disease with an additional exposed subpopulations as an interphase between the susceptible and the infected state (SEI-models). Besides, certain diseases do not allow permanent recovery and the person affected joins the susceptible pool again. Examples include gonorrhoea or encephalitis, which are represented in SIS-models and do not comprise a recovered pool, or for instance the seasonality of influenza is represented in SIRS-models \citep{dadlani2013}.}\textsuperscript{,}\footnote{The decision to rely our analysis on an SIR-model is explained in SECTION 123.} 

Underlying these compartmental models is the mass-action assumption, meaning that a homogeneous population is assumed in which all individuals are connected (\citeauthor{heesterbeek2005}, \citeyear{heesterbeek2005}; \citeauthor{rusu2015}, \citeyear{rusu2015}; \citeauthor{wilson1945a}, \citeyear{wilson1945a}). These limitations have been tackled by working with networks which allow to weaken the mass-action assumption, thus providing a better fit for the combination of population structures and disease transmissions (\citeauthor{keeling2005}, \citeyear{keeling2005}; \citeauthor{meyers2005}, \citeyear{meyers2005}).\footnote{Network models that are commonly utilised include random networks, lattices, small-world or scale-free networks, amongst others \citep{keeling2005}.}    

For instance, \cite{liu2015} show that the network structure, here a small-world network, has a crucial impact on the percolation of an infectious disease.\footnote{\cite{liu2015} work with small-world networks that are created by randomly dis- and reconnecting the edges in two lattice-structures. Especially for a smaller infection rate, reducing the distances of the networks significantly contributes to a stronger spread of the disease.} 
The network structure is decisive for the epidemic threshold, which determines the onset of an epidemic. For complex networks, \cite{pastor2002} show that eradication of infections cannot be achieved by random uniform immunization of individuals. Concerning small-world networks, the deduction of the percolation threshold, for both bond and site percolation, can be found in prior works of \cite{newman1999} and \cite{moore2000}. 

By analysing hierarchical configuration models, formed by connecting communities in networks, the work of \cite{stegehuis2016} shows that the mesoscopic set of communities has the main influence on percolations in networks.

Not only have network structures a significant impact on the range and transmission of an infectious disease, but they enable a shift in perspective to focus more on the individual agent with the related neighbourhood. 
Analysing the individual agent by adopting a game-theoretical perspective, the calculation of payoffs from vaccination and infection are of significance. 

Starting with the simple game-theoretical model in \cite{bauch2004}, they find that even minimal risks associated with a vaccination drive the uptake levels below the eradication threshold, given that agents behave selfishly. 
Introducing evolutionary game-theory with social learning, the work of \cite{bauch2012} displays that these features allow for a better explanation of the evolution of vaccine-scares, which is further analysed in subsequent works.
Analysing groups with different beliefs concerning vaccination decisions has gained further interest. For instance, \cite{liu2012} find that the presence of committed vaccinators increases uptake of vaccinations and avoids clustering of susceptibles for agents relying on adaptive-learning.  

Combining the game-theoretical perspective with network structures yields further results that are important for epidemiology.   
\cite{fu2010} show that agents forming beliefs by relying on adaptive-learning in complex networks, arrive at suboptimal vaccination levels. An outcome that is exacerbated when the selection of successful strategies is sensitive. Furthermore, the network structure has the potential to increase uptake levels, while it may serve as a catalyst to vaccination refusal for increases in vaccination costs.  
\cite{shi2017} examine the effects of complex network structures on individual vaccine uptake in mixed strategies. Given an increase of the relative costs of vaccination, they find that heterogenous network structures preserve vaccination rates when compared to regular networks. Moreover, if only direct neighbours are considered, highly connected individuals are likelier to vaccinate, compared to the case of neighbours of neighbours. 

Especially, the work of \cite{shim2012} motivates the approach that is employed in this paper. Providing a game-theoretical model of measles transmissions, they analyse the effect of perceived vaccine risks on uptake levels for a population divided into vaccine-sceptics and -believers. It is confirmed that uptake levels are lower if agents behave selfishly, which is more severe for vaccine-sceptics. Moreover, and of particular importance, they show that it is mainly the fraction of vaccine-sceptics, as opposed to their discrepancy in assessing vaccine risks, which drives reduced uptake levels. 

%--------------------------------------------------------------------------------------------------------------------------------
%--------------------------------------------------------------------------------------------------------------------------------
%--------------------------------------------------------------------------------------------------------------------------------
%--------------------------------------------------------------------------------------------------------------------------------
%--------------------------------------------------------------------------------------------------------------------------------
%--------------------------------------------------------------------------------------------------------------------------------

\section{Description of the Model}

% Considerations regarding the disease and the modelled time-horizon:
% Assume an outbreak of a severe disease with the possibility to receive a vaccination that works immediately when not yet infected. 

The general assumptions of our model are as follows:
\begin{itemize}
\item{The infectious disease is modelled as a time-homogeneous Markov chain with a finite state space according to an SIVR-process with 'vaccinated', respectively 'recovered' representing the final or absorbing states with permanent immunity. The population is assumed to stay constant.}
\item{Agents are assumed to be rational utility-maximisers endowed with complete information about their immediate neighborhood. They decide in each time-step whether or not to update their vaccination decision and hence if they will get vaccinated employing a mixed strategy.}
\item{When facing the vaccination decision, each agent samples the health status of its direct neighborhood and deduces the probability of infection during the next epoch from the amount of infected neighbors.}
\item{The time-horizon of an agent is bounded, in the sense that only a certain amount of time-steps is considered in the calculation of expected utility to be maximized through the vaccination-decision.}
\item{Agents have a group affiliation to either be skeptical (group: 'skepticals') or trust (group: 'trusters') that vaccines are safe. The group membership of an agent determines the subjective costs they assign to vaccination, while the costs of infection are assumed to be equal between groups.}
\item{The population structure is modelled as a small-world network, relying on a Watts-Strogatz model. We assume the two groups to represent small-worlds on their own. These two networks are then combined assuming that closeness in a group is larger than between groups.}
\end{itemize}
The work of SHIM ET AL motivates the agent decision process implemented in the model and is partly derived from their analysis. Still, the approach developed in the present work deviates from it in several respects. First off, a discrete-time rather than continuous time Markov process is used to describe disease dynamics. This choice is justified both on simplicity grounds and because at least part of the dynamics -such as meeting other agents- are inherently discrete events. Secondly, individual transition probabilities are based on the local instantaneous incidence of infection rather than the steady endemic distribution. The latter is justified by the fact that the present model employs a network structure for the population rather than a lumped, well mixed approximation. Moreover, the derivation of the vaccination policy does not aim to obtain the Nash equilibrium strategy for the population but rather a locally optimal update rule under non-equilibrium conditions.
%Restriction to the assumption of complete information, but can on the other hand justify the Markov process rule

Concerning the epidemiological part of our model, the spread of the disease in the population follows an SIVR-process. Thus, the population is divided into (1) susceptible (2) infectious (3) recovered and (4) vaccinated subpopulations. The subpopulations are the same for the two belief-groups of skepticals and trusters. Susceptible agents can transition to the infectious state, \(S \rightarrow{} I \), by at least one contagious interaction with an infected neighbor; individual interactions have probability \(\beta\) of infecting a susceptible agent, while the total probability of infection \(\lambda_{k}(t)\) depends on the number of infected neighbors. I On the other hand, if the agent decides to vaccinate it transitions according to the rule \(S \rightarrow{} V \) with probability \(p_{vacc}(t)\) at time-step \(t\). Infectious agents recover by the probability \(\gamma_{k}\), \(I \rightarrow{} R\). Recovered, respectively vaccinated, agents stay in their respective state which can be regarded as isomorphic with the exception of how these states are reached. Both recovered and vaccinated agents are assumed to become fully immunized. A constant population is assumed in a way that no entries, via birth, or exits, via death, are taken into account.\footnote{A more detailed version of the SIVR-model can be found in XYZ or ABC.}

\subsection{Epidemic dynamics}

The evolution of the $\mathit{k}^{th}$ agent state is summarised in the stochastic matrix \(\mathbf{Q}_k(t)\) and the health-state probability vector \(\mathbf{x}_k(t)\). The disease-specific parameters and transmission rates are outlined below:

\begin{equation}\label{eq:1}
	 \mathbf{x}_k(t+1) = \mathbf{Q}_k(t) \cdot \mathbf{x}_k(t)
\end{equation}

and:

\begin{equation}\label{eq:2}
	 \mathbf{Q}_k(t) = 
	 \left (\begin{array}{cccc} p_{k}(S\rightarrow{}S)&p_{k}(I\rightarrow{}S)&p_{k}(R\rightarrow{}S)&p_{k}(V\rightarrow{}S) \\
	 	p_{k}(S\rightarrow{}I)&p_{k}(I\rightarrow{}I)&p_{k}(R\rightarrow{}I)&p_{k}(V\rightarrow{}I) \\
		p_{k}(S\rightarrow{}R)&p_{k}(I\rightarrow{}R)&p_{k}(R\rightarrow{}R)&p_{k}(V\rightarrow{}R) \\
		p_{k}(S\rightarrow{}V)&p_{k}(I\rightarrow{}V)&p_{k}(R\rightarrow{}V)&p_{k}(V\rightarrow{}V) \\
	  \end{array} \right)
\end{equation}

In particular: 

\begin{equation}\label{eq:3}			% time-dependency of Q_{k}
	 \mathbf{Q}_k(t) = 
	 \left (\begin{array}{cccc} 1-\lambda_{k}(t)&0&0&0 \\
	 	\lambda_{k}(t)&1-\gamma_{k}&0&0 \\
		0&\gamma_{k}&1&0 \\
		0&0&0&1 \\
	  \end{array} \right)
\end{equation}

For infected agents, the probability of transitioning to a recovered state or remaining infected does not depend on the spread of the disease nor can it be influenced by a decision to vaccinate. Given the absorbing quality of recovered and vaccinated states, this means that only susceptible individuals are active decision makers in the population. For purely susceptible agents, the health probability vector:

\begin{equation}\label{eq:4}
	\mathbf{x}_k(t)^T=\left(\begin{array}{cccc} 1-p_{vacc},&0,&0,&p_{vacc}  \end{array} \right),
\end{equation} 

represents their state at time \(t\) after the choice of vaccination strategy. 

% INITIAL STATES

As outlined above, \(\beta\) represents the probability for an agent of getting infected by a single interaction. This parameter is assumed to be disease-specific, and thus constant in value and independent of the agent's state. The probability of infection \(\lambda_{k}(t)\) for an agent interacting with it's entire neighbourhood results:

\begin{equation}\label{eq:5}
	\lambda_{k}(t)=1-(1-\beta)^{n_{k}(t)},
\end{equation}

with the integer \(n_{k}(t)\) representing the instantaneous number of infected neighbours of agent \(k\) at time \(t\). %, which takes the following form: xyz % age-specific 
%sampling the neighbourhood at \(t=0\)

\subsection{Agent policy}

A susceptible agent, being a rational utility-maximizer, faces the vaccination decision by solving the optimization problem:

\begin{equation}\label{eq:6}
	\max_{{p_{vacc}}} \; U_k(\mathbf{x}_k(t), T)
\end{equation}

where \(T\) represents the time-horizon of the agent. The expected utility function takes the subsequent form, following the Bellman equation for a discrete-time Markov process:

% reference for Bellmann equation
\begin{equation}\label{eq:7}
	\begin{split}
		U_k(\mathbf{x}_k(t), T) = \sum_{t'=t}^{t + T} \frac{\mathbf{x}_k(t') \cdot \mathbf{f}_k(t')}{(1+r)^{(t'-t)}}
	\end{split}
\end{equation}

where \(\mathbf{f}_k(t)\) is the payoff vector of agent \(k\) with: 

% Payoff-vectors
\begin{equation}\label{eq:8}
	\mathbf{f}_k(t' = t)=\left( \begin{array}{cccc}0&0&0&-C_{v,k} \end{array} \right)^T
	% other suggestions for transpose T
\end{equation}

and:

\begin{equation}\label{eq:9}
\mathbf{f}_k(t' > t)=\left( \begin{array}{cccc} 0&-C_{i,k}&0&0 \end{array} \right)^T  
\end{equation}

represent the immediate vaccination payoffs, respectively the payoffs per time step as a result of infection.  
The different components of the perceived cost, among others the market price of the vaccine and it's expected side-effects conditional on the agent's beliefs, are included in \(C_{v,k}\). Besides, \(C_{i,k}\) captures the costs of infection, including medical treatment expenditures, absence from work or reduced personal well-being. Finally, agents discount the payoffs of future events using a discount rate \(r\).\\
Even though the actual infection probability  \(\lambda_{k}(t)\) is time dependent due to fluctuations in the incidence of the disease in the population, it is assumed to lie beyond the capabilities of any individual to simulate the entire social network for an accurate prediction of its evolution. Instead, each susceptible agent makes a point estimation \(\hat{\lambda}_{k}\) and assumes it to be constant during the forward time-horizon \(T\). The latter hypothesis amounts to treating the infection dynamics as a stationary Markov chain at the agent level:

\begin{equation}\label{eq:10}
	 \mathbf{x}_k(t+1) = \hat{\mathbf{Q}}_k \cdot \mathbf{x}_k(t)
\end{equation}

with:

\begin{equation}\label{eq:11}
	 \hat{\mathbf{Q}}_k = 
	 \left (\begin{array}{cccc} 1-\hat{\lambda}_{k}&0&0&0 \\
	 	\hat{\lambda}_{k}&1-\gamma_{k}&0&0 \\
		0&\gamma_{k}&1&0 \\
		0&0&0&1 \\
	  \end{array} \right)
\end{equation}

Given that the evolution of a stationary Markov chain is independent of any absolute time reference, without loss of generality \eqref{eq:7} can be rewritten using $t = 0$. Employing \eqref{eq:8} and \eqref{eq:9}:

\begin{equation}\label{eq:12}
	U_k(\mathbf{x}_k(0), T)= \mathbf{x}_k(0) \cdot \mathbf{f}_k(0) + \sum_{t=1}^{T} {\mathbf{x}_k(0) \cdot \left(\frac{ \hat{\mathbf{Q}}_k}{1+r}\right)^t \cdot \mathbf{f}_k(t)}
\end{equation}

In order to compute the power \({\hat{\mathbf{Q}}_k}^t\), the matrix can be diagonalized:

\begin{equation}\label{eq:13}
	\hat{\mathbf{Q}}_k=\hat{\mathbf{R}}_{k}\hat{\mathbf{\Lambda}}_{k}\hat{\mathbf{R}}^{-1}_{k}
\end{equation}

And we can rewrite \eqref{eq:12} as follows:

\begin{equation}\label{eq:14}
	U_k(\mathbf{x}_k(0), T)= \mathbf{x}_k(0) \cdot \left[ \mathbf{f}_k(0) + \hat{\mathbf{R}}_{k} \cdot \sum_{t=1}^{T} { \left(\frac{ \hat{\mathbf{\Lambda}}_{k}}{1+r}\right)^t \cdot \hat{\mathbf{R}}^{-1}_{k} \cdot \mathbf{f}_k(t)} \right]
\end{equation}

Finally, performing the required computations we obtain: 

\begin{equation}\label{eq:15}
	U_k(\mathbf{x}_k(0), T)=-p_{vacc} \cdot C_{v,k} - (1-p_{vacc}) \cdot C_{notv,k}
\end{equation}

where: 

\begin{equation}\label{eq:16}
	C_{notv,k}=C_{i,k} \cdot \left( \frac{\hat{\lambda}_{k}}{\gamma_{k}-\hat{\lambda}_{k}} \right) \cdot \left[\sum_{t = 1}^{T} \left(\frac{1-\hat{\lambda}_{k}}{1+r}\right)^t - \sum_{t = 1}^{T}\left(\frac{1-\gamma_k}{1+r}\right)^t\right]
\end{equation}

Equation \eqref{eq:16} is linear in \(p_{vacc}\), so it has only one global maximum which depends on the relative cost of each decision. In particular, the preferred strategies are the following:

\begin{equation}\label{eq:17}
	\begin{array}
	{@{}lr@{}}
        \multirow{p_{vacc}=0,} & \text{for }C_{v,k}>C_{notv,k} \\
        {p_{vacc}=1,} & \text{for }C_{notv,k}>C_{v,k} \\
        {p_{vacc}\in(0,1),} & \text{for }C_{v,k}=C_{notv,k} \\
    \end{array}
\end{equation}

Thus, agents follow a pure strategy for almost all values of \(C_{v,k}\), \(C_{i,k}\), \(\gamma_{k}\), \(\hat{\lambda}_{k}\) and \(T\). It is clear from Equation\eqref{eq:17} that \textit{ceteris paribus} a different vaccination strategy will be chosen depending on each agent's beliefs, manifested through different relative values for \(C_{v,k}\) and \(C_{i,k}\). In particular, it is expected that individuals skeptical towards vaccines will preferentially decide not to vaccinate for a given infection probability estimate \(\hat{\lambda}_{k}\) and time window \(T\), as they consider the costs to be higher than what individuals who believe in the effectiveness of vaccines do.

Ref.:
\cite{shim2012}



INITIAL SETUP
IN OUR CALCUALTIONS, WE USE THE PARAMETERS AS OUTLINED BELOW:
......

%-----------------------------------------------------------------------------------------------

--------------- \\

NETWORK \\
The hierarchical configuration model in STEGEHUIS ET AL provides an orientation for the model which is employed in this thesis. Adopting the two belief-groups, these are identified as sub-communities of the whole population. Each group is assumed to have a close intra-connection and a looser inter-connection. A small-world model is employed by formulating Watts-Strogatz networks (WATTS STROGATZ) for every group, which are then connected as outlined below. \\
Each community \(G\in{\{T,S\}}\) is a subset of the whole population \(N\), \(G\subset{N}\), with T representing 'trusters' and S representing 'skepticals'. Furthermore, 
\begin{equation}
g\colon \mathbb{N} \rightarrow{\{1,2\}}, 
\begin{align*}
g(i)\mapsto \left\{
\begin{array}{ll}	1, & i\textrm{ in group }T \\
	2, &  i\textrm{ in group }S \\
\end{array} \right 
\end{align*}
\end{equation}
indicates community-membership for an individual agent \(i\in{N}\).
The groups consist of a total of \(n_{G}\) members, according to \(n_{G}=\sum_{i\in{N}}p_{G}(i)=p_{G}(i)*n\). With \(n={\[\|N\|}\) being the number of nodes in the total population \(N\). Furthermore, \(p_{G}(i)\) defines the probabilistic group allocation for a node \(i\) to be assigned to group \(m\in{\{1,2\}}\), such that 
\begin{equation} 
\begin{align*}
\(p_{m}(i)=\left\{
\begin{array}{ll}	p_{1}, & i\textrm{ assigned to }T \\
	1-p_{1}=p_{2}, &  i\textrm{ assigned to  }S \\
\end{array} \right\)
\end{align*}
\end{equation}
and \(p_{G}(i)\) is independent of the individual agent \(i\). \\
The Watts-Strogatz graph for every group \(G\subset{N}\) is then built by taking into account \(k(i)\), the number of nearest neighbours of \(i\) that \(i\) is connected to in a ring topology. \\ 
Thereafter, the two graphs are combined by adding an additional fraction of the edges in both groups for any two members \(i,j\in{N},i\neq j,\) of different groups, requiring \(g(i)\neq g(j)\). The amount of edges \(e_{add}\) is the fraction according to 
\begin{equation}
e_{add}=a*e_{G}=a*\bigg(\sum_{i\in{T}}k(i) + \sum_{j\in{S}}k(j)\bigg),
\end{equation}
 with \(a\in{(0,1)}\), and \(e_{G}=(\sum_{i\in{T}}k(i) + \sum_{j\in{S}}k(j))\) the total of edges in both groups. Any two members of different groups are then randomly connected until the added connections reaches \(e_{add}\).  \\
%-----
NEIGHBOURS OF NEIGHBOURS: SHI ET AL (2017)


% ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------

%------------------------------
%   IMPLEMENTATION
%------------------------------

\section{Implementation}

All our calculations are carried out in Python. More specifically we used $networkx$ for creating the network, $numpy$ for calculations and $matplotlib$ to visualize the results.

The code is split up in three files. $main.py$ forms the core of the simulation and is the only file that should be executed. Also, all variables that characterize the simulation and can be altered in $main.py$ to obtain different results.

\subsection{Creating the network}
By executing $main.py$ an object of type $SmallWorldNetwork$ (defined in\\ $small\_world\_network.py$) is created. The parameters characterizing the network are $n$, $group\_percentages$, $k$, $change\_edge\_percentage$ and $alpha$ defined at the beginning of $main.py$.

$n$ defines the total number of nodes in the network. This number is then split up into different groups according to $group\_percentages$. For example, if $n=100$ and $group\_percentages = [0.2, 0.8]$ two groups are created. One with 20 nodes and one with 80 nodes. For each of these groups a Watts-Strogatz model is created using $k$ and $change\_edge\_percentage$. In a Watts-Strogatz model each node is connected to its $k$ nearest neighbors. Then each edge is rewired with a probability of  $change\_edge\_percentage$.

After creating a model for each group, the individual groups are loosely connected with a percentage $alpha$. In other words $alpha * n$ nodes are connected to both groups while all other nodes only share edges with nodes of the same group.

Thus, it is more likely to be connected to members of your own group but at the same time groups are never completely isolated from each other. 

In a last step the created network is populated with agents. Hence, for each node an agent with the respective group type is created and stored in a list. The initial health status (susceptible, infected or vaccinated) is derived from rates defined in $lim\_init\_infected$ and $lim\_init\_vacci$. Furthermore, each agent has a certain age that is derived from a normal distribution using $age\_mu$ and $age\_simga$.

Age is only included for possible extensions of the model in the future. It is not being used in our model.


\subsection{Simulating the agents' behaviour}
Almost all functions in $main.py$ are responsible for visualizing the results.
The simulation itself almost entirely takes place in the $Agent$ class defined in $agent.py$.


In our case every iteration represents a day in the agents' life. The number of days to be simulated is defined by the variable $frames$.
Hence, every day the main file loops over all agents in the network and thus calls the $run$ function exactly once (per day). Starting from the $run$ function a number of other functions is called that determine whether the agent is getting infected, recovers or vaccinates. For the decision of vaccination the $act$ function gathers the different values needed in equation \eqref{eq:16} to ultimately decide whether to vaccinate or not (equations \eqref{eq:17}).


%------------------------------
%   RESULTS AND DISCUSSION
%------------------------------
\section{Simulation Results and Discussion}


%------------------------------
%   SUMMARY AND OUTLOOK
%------------------------------

\section{Summary and Outlook}






\bibliographystyle{agsm}
\bibliography{/Users/JuliusSiebenaller/Desktop/Vacci-Nation/Report/References.bib}
\clearpage

\end{document}  



 
