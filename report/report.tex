\documentclass[11pt]{article}
\usepackage{geometry}                
\geometry{a4paper}                   

\usepackage[latin1]{inputenc}

\usepackage[colorlinks, linkcolor=blue, citecolor=blue, filecolor=blue, urlcolor=blue]{hyperref}
\usepackage{hyperref}
\usepackage[nottoc,notlot,notlof]{tocbibind}

\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage[comma]{natbib}
\usepackage{amssymb, amsmath}
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\title{Epidemiology \& Immunization}
\author{Julius Siebenaller, Jannes Huehnerbein, Benjamin Gundersen, Nicolas Antunes Morgado}
\date{November 2019} 

\begin{document}


\input{cover}

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% AGREEMENT FOR PUBLISHING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section*{Agreement for free-download}
\bigskip
\bigskip

\large We hereby agree to make our source code for this project freely available for download from the web pages of the Computational Social Science chair. Furthermore, we assure that all source code is written by ourselves and is not violating any copyright restrictions.

\begin{center}
\bigskip
\bigskip
\bigskip
\bigskip

\begin{tabular}{@{}p{8cm}@{}@{}p{8cm}@{}}

\begin{minipage}{8cm}
\large Nicolas Antunes Morgado
\end{minipage}

&
\begin{minipage}{8cm}
\large Benjamin Gundersen
\end{minipage}

\end{tabular}


\vspace{3\baselineskip}

\begin{tabular}{@{}p{8cm}@{}@{}p{8cm}@{}}

\begin{minipage}{8cm}
\large Julius Siebenaller
\end{minipage}
&
\begin{minipage}{8cm}
\large Jannes H\"uhnerbein
\end{minipage}
\end{tabular}

\end{center}


\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



% IMPORTANT
% you MUST include the ETH declaration of originality here; it is available for download on the course website or at http://www.ethz.ch/faculty/exams/plagiarism/index_EN; it can be printed as pdf and should be filled out in handwriting


%%%%%%%%%% Table of content %%%%%%%%%%%%%%%%%

\tableofcontents

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BEGIN REPORT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Abstract}
This paper describes our approach in simulating a fictional society and its vaccination behaviour throughout a single flu season (i.e. one winter).

The model that we want to investigate is split into two groups. One being very trusting towards vaccinations; the other having a more skeptical attitude.

The main emphasis is being placed on investigating different distributions, thus changing the composition of society in terms of what percentage is trusting or skeptical towards vaccinating and what effect this has on the flu outbreak.
\newpage


\section{Individual contributions}
\section{Introduction and Motivations}
Several times in human history epidemics have left areas and sometimes entire civilizations in total devastation. Only with the rise of modern medicine and especially widely available vaccines the development of large and complex societies of today was made possible.

The characteristics of the flu with its almost yearly outbreaks and frequent mutations - making a general vaccine impossible to develop - yield an interesting game theoretical problem.

In this project we want to investigate the behaviour of a fictional society by splitting it up into two different groups. One group trusts vaccines and hence needs very little incentive to get vaccinated ('trusters'). The other group is very skeptical towards the cost and return of vaccines and hence vaccinates much later, sometimes not at all ('skepticals').

With 'anti-vaxing' groups becoming more popular and diseases thought to be extinct reappearing even in Central Europe \footnote{e.g. a case of measles at ETH Zurich in summer 2019} this question is gaining relevance and hence we decided to take a closer look at it.


%----------------------------------------------------------------------------------------------------
%----------------------------------------------------------------------------------------------------
\section{Literature Review}
The following provides a small review of the literature concerning (1) the modelling of infectious diseases with respect to population structures and subpopulations as well as disease spreading. And (2) a game theoretical analysis regarding the vaccination decisions of individuals. 

The work of \cite{kermack1927} is pivotal in the field of epidemiology, particularly concerning the spread of an infectious diseases in a population. Susceptible persons get infected based on the transmission rate of the disease and the size of the infectious subpopulation. They finally recover or die from the disease and hence join and stay in the recovered pool. This and subsequent compartmental models are commonly referred to as SIR-models of infectious diseases. 
As outlined in \cite{earn2008}, respectively in \cite{dadlani2013} or \cite{sun2016}, there exist various adaptations of the SIR-compartmental-model to either allow for different subpopulations, or to modify the disease process.\footnote{The case of severe acute respiratory syndrome (SARS) serves as an example to model the infectious disease with an additional exposed subpopulations as an interphase between the susceptible and the infected state (SEI-models). Besides, certain diseases do not allow permanent recovery and the person affected joins the susceptible pool again. Examples include gonorrhoea or encephalitis, which are represented in SIS-models and do not comprise a recovered pool, or for instance the seasonality of influenza is represented in SIRS-models \citep{dadlani2013}.} 

Underlying these compartmental models is the mass-action assumption, meaning that a homogeneous population is assumed in which all individuals are connected (\citeauthor{heesterbeek2005}, \citeyear{heesterbeek2005}; \citeauthor{rusu2015}, \citeyear{rusu2015}; \citeauthor{wilson1945a}, \citeyear{wilson1945a}). These limitations have been tackled by working with networks which allow to weaken the mass-action assumption, thus providing a better fit for the combination of population structures and disease transmissions (\citeauthor{keeling2005}, \citeyear{keeling2005}; \citeauthor{meyers2005}, \citeyear{meyers2005}).\footnote{Network models that are commonly utilised include random networks, lattices, small-world or scale-free networks, amongst others \citep{keeling2005}.}    

A strand of literature has been published regarding the influence of the network structure on the percolation of the disease, meaning the spread of the infectious disease in the population. In particular, attention has been put on analysing and calculation the percolation threshold for different population structures. 
Concerning small-world networks, the deduction of the epidemic threshold, for both bond and site percolation, can be found in prior works of \cite{newman1999} and \cite{moore2000}. 
The network structure is decisive for the epidemic threshold, which determines the onset of an epidemic. For complex networks, \cite{pastor2002} show that eradication of infections cannot be achieved by random uniform immunisation of individuals. 
Analysing small-world networks, \cite{liu2015} confirm the crucial effect of network structure on the spreading of an infectious disease.\footnote{\cite{liu2015} work with small-world networks that are created by randomly dis- and reconnecting the edges in two lattice-structures. Especially for a smaller infection rate, reducing the distances of the networks significantly contributes to a stronger spread of the disease.} 

Not only have network structures a significant impact on the range and transmission of an infectious disease, but they enable a shift in perspective to focus more on the individual agent with the related neighbourhood. 
Analysing the individual agent by adopting a game-theoretical perspective, the calculation of payoffs from vaccination and infection are of significance. 

Starting with the simple game-theoretical model in \cite{bauch2004}, they find that even minimal risks associated with a vaccination drive the uptake levels below the eradication threshold, given that agents behave selfishly. 
Introducing evolutionary game-theory with social learning, the work of \cite{bauch2012} displays that these features allow for a better explanation of the evolution of vaccine-scares, which is further analysed in subsequent works.
Analysing groups with different beliefs concerning vaccination decisions has gained further interest. For instance, \cite{liu2012} find that the presence of committed vaccinators increases uptake of vaccines and avoids clustering of susceptibles for agents relying on adaptive-learning.  

Combining the game-theoretical perspective with network structures yields further results that are important for epidemiology.   
\cite{fu2010} show that agents forming beliefs by relying on adaptive-learning in complex networks, arrive at suboptimal vaccination levels, which is exacerbated when the selection of successful strategies is sensitive. Furthermore, the network structure has the potential to increase uptake levels, while it may serve as a catalyst to vaccination refusal for increases in vaccination costs. \cite{shi2017} examine the effects of complex network structures on individual vaccine uptake in mixed strategies. Given an increase of the relative costs of vaccination, they find that heterogenous network structures preserve vaccination rates when compared to regular networks. Moreover, if only direct neighbours are considered, highly connected individuals are likelier to vaccinate, compared to the case of neighbours of neighbours. (\citeauthor{shi2017}, \citeyear{shi2017})

Especially, the work of \cite{shim2012} motivates the approach that is employed in this paper. Providing a game-theoretical model of measles transmissions, they analyse the effect of perceived vaccine risks on uptake levels for a population divided into vaccine-sceptics and -believers. It is confirmed that uptake levels are lower if agents behave selfishly, which is more severe for vaccine-sceptics. Moreover, and of particular importance, they show that it is mainly the fraction of vaccine-sceptics, as opposed to their discrepancy in assessing vaccine risks, which drives reduced uptake levels. 
Especially the last finding is confirmed in \cite{Stegehuis2016}. By analysing hierarchical configuration models, formed by connecting communities in networks, this work shows that the mesoscopic set of communities has the main influence on percolations in networks. 

%----------------------------------------------------------------------------------------------------
%----------------------------------------------------------------------------------------------------
\section{Description of the Model}
The general assumptions of our model are as follows:
\begin{itemize}
\item{The infectious disease is modelled as a time-homogeneous Markov chain with a finite state space according to an SIVR-process with 'vaccinated', respectively 'recovered' representing the final or absorbing states with permanent immunity. The population is assumed to stay constant.}
\item{Agents are assumed to be rational utility-maximisers endowed with complete information about their immediate neighbourhood. They decide in each time-step whether or not to update their vaccination decision and hence if they will get vaccinated employing a mixed strategy.}
\item{When facing the vaccination decision, each agent samples the health status of its direct neighbours and deduces the probability of infection during the next epoch from the share of infected neighbours.}
\item{The time-horizon of an agent is bounded, in the sense that only a certain amount of time-steps is considered in the calculation of expected utility to be maximised through the vaccination-decision.}
\item{Agents have a group affiliation to either be skeptical (group: 'skepticals') or trust (group: 'trusters') that vaccines are safe. The group membership of an agent determines the subjective costs they assign to vaccination, while the costs of infection are assumed to be equal between groups.}
\item{The population structure is modelled as a small-world network, relying on a Watts-Strogatz model. We assume the two groups to represent small-worlds on their own. These two networks are then combined assuming that closeness in a group is larger than between groups.}
\end{itemize}

Concerning the epidemiological part of our model, the spread of the disease in the population follows an SIVR-process. Thus, the population is divided into (1) susceptible (2) infectious (3) recovered and (4) vaccinated subpopulations. The subpopulations are the same for the two belief-groups of scepticals and trusters. Susceptible agents can transition to the infectious state, \(S \rightarrow{} I \), by at least one interaction with an infected, hence contagious, neighbour. Individual interactions have probability \(\beta\) of infecting a susceptible agent, while the actual probability of infection \(\lambda_{k}(t)\) depends on the number of infected neighbours. On the other hand, the agent decides to vaccinate with probability \(p_{vacc}(t)\) at time-step \(t\) and the transitions occurs according to the rule \(S \rightarrow{} V \). Infectious agents recover by the probability \(\gamma_{k}\) with transition \(I \rightarrow{} R\). Recovered, respectively vaccinated, agents stay in their respective state which can be regarded as isomorphic with the exception of how these states are reached. Both recovered and vaccinated agents are assumed to become fully immunised. A constant population is assumed in a way that no entries, via birth, or exits, via death, are taken into account.\footnote{A more detailed version of the SIVR-model can be found in \cite{tornatore2014}.}

With regards to the agent's decision and infection propagation processes, the work of \cite{shim2012} motivated the modelling choices, which are partly derived from their analysis. Still, the approach developed in the present work deviates from it in several respects:
First off, a discrete-time rather than continuous time Markov process is used to describe disease dynamics. This choice is justified both on simplicity grounds and because at least parts of the mechanism leading to contracting a disease, such as meeting other agents, can be considered inherently discrete events. Secondly, \cite{shim2012} employ time dependent population balances to derive steady state solutions to an endemic disease (measles), while the decision to vaccinate newborns by their parents has long-term effects. This leads to the explicit modelling of birth-death rates in the population balances and the use of infinitely long time horizons when calculating the agent's expected utilities. The large time scales associated with the decision to vaccinate also give credibility to the assumption of complete knowledge of population-level information, such as the global steady state incidence of measles which is likely available to parents who decide to vaccinate their children. Finally, this game-theoretic setting is sufficient for the existence of a Nash equilibrium which the authors derive for the diverging vaccination policies of different social groups.

In opposition, in the present work we attempted to describe an infectious disease with short time scales of propagation and recovery, with characteristics of an unexpected outbreak for which a vaccine could be readily available for any individual independently of it's age.\footnote{An empirical example satisfying the employed definition would be the H1N1 avian flu pandemic of 2009.}. Under these conditions we do not expect to reach an endemic steady state but a mixture of immunised agents, either due to recovery or to vaccination. Moreover, the effective consequences of the decision to vaccinate are assumed to be limited in time, and so agents should only have access to information from their local social links and prior beliefs to evaluate the costs involved. This implies that no Nash equilibrium can arise at the population level, but rather a set of heterogeneous decisions under non-equilibrium conditions. All in all, these are the reasons why birth-death terms in population balances are omitted. Therefore, the time-horizon and knowledge of the infection prevalence to each agent's neighbourhood in the determination of their expected utility is limited, and  a network structure for the population rather than a well mixed approximation is relied on. 

%----------------------------------------
\subsection{Epidemic dynamics}

The evolution of the states of agent \(k\) is summarised in the stochastic matrix \(\mathbf{Q}_k(t)\) and the health-state probability vector \(\mathbf{x}_k(t)\). The disease-specific parameters and transmission rates are outlined below:

\begin{equation}\label{eq:1}
	 \mathbf{x}_k(t+1) = \mathbf{Q}_k(t) \cdot \mathbf{x}_k(t)
\end{equation}
and:
\begin{equation}\label{eq:2}
	 \mathbf{Q}_k(t) = 
	 \left (\begin{array}{cccc} p_{k}(S\rightarrow{}S)&p_{k}(I\rightarrow{}S)&p_{k}(R\rightarrow{}S)&p_{k}(V\rightarrow{}S) \\
	 	p_{k}(S\rightarrow{}I)&p_{k}(I\rightarrow{}I)&p_{k}(R\rightarrow{}I)&p_{k}(V\rightarrow{}I) \\
		p_{k}(S\rightarrow{}R)&p_{k}(I\rightarrow{}R)&p_{k}(R\rightarrow{}R)&p_{k}(V\rightarrow{}R) \\
		p_{k}(S\rightarrow{}V)&p_{k}(I\rightarrow{}V)&p_{k}(R\rightarrow{}V)&p_{k}(V\rightarrow{}V) \\
	  \end{array} \right)
\end{equation}
In particular: 
\begin{equation}\label{eq:3}			
	 \mathbf{Q}_k(t) = 
	 \left (\begin{array}{cccc} 1-\lambda_{k}(t)&0&0&0 \\
	 	\lambda_{k}(t)&1-\gamma_{k}&0&0 \\
		0&\gamma_{k}&1&0 \\
		0&0&0&1 \\
	  \end{array} \right)
\end{equation}

For infected agents, the probability of transitioning to a recovered state or remaining infected does not depend on the spread of the disease nor can it be influenced by a decision to vaccinate. Given the absorbing quality of recovered and vaccinated states, this means that only susceptible individuals are active decision makers in the population. For purely susceptible agents, the health probability column vector:

\begin{equation}\label{eq:4}
	\mathbf{x}_k(t)^{'}=\left(\begin{array}{cccc} 1-p_{vacc},&0,&0,&p_{vacc}  \end{array} \right),
\end{equation} 
represents their state at time \(t\) after the choice of vaccination strategy. 

As outlined above, \(\beta\) represents the probability for an agent of getting infected by a single interaction. This parameter is assumed to be disease-specific, and thus constant in value and independent of the agent's state. The probability of infection \(\lambda_{k}(t)\) for an agent interacting with it's entire neighbourhood results:
\begin{equation}\label{eq:5}
	\lambda_{k}(t)=1-(1-\beta)^{n_{k}(t)},
\end{equation}
with the integer \(n_{k}(t)\) representing the instantaneous number of infected neighbours of agent \(k\) at time \(t\). 

%------------------------------------
\subsection{Agent policy}

A susceptible agent, being a rational utility-maximiser, faces the vaccination decision by solving the optimisation problem:
\begin{equation}\label{eq:6}
	\max_{{p_{vacc}}} \; U_k(\mathbf{x}_k(t), T),
\end{equation}
where \(T\) represents the time-horizon of the agent. The expected utility function takes the subsequent form, following the Bellman equation for a discrete-time Markov process:
\begin{equation}\label{eq:7}
	\begin{split}
		U_k(\mathbf{x}_k(t), T) = \sum_{t'=t}^{t + T} \frac{  \mathbf{f}_k(t') \cdot \mathbf{x}_k(t')}{(1+r)^{(t'-t)}},
	\end{split}
\end{equation}
where \(\mathbf{f}_k(t)\) is the payoff row vector of agent \(k\) with: 
% Payoff-vectors
\begin{equation}\label{eq:8}
	\mathbf{f}_k(t' = t)=\left( \begin{array}{cccc}0&0&0&-C_{v,k} \end{array} \right)
	% other suggestions for transpose T
\end{equation}
and:
\begin{equation}\label{eq:9}
\mathbf{f}_k(t' > t)=\left( \begin{array}{cccc} 0&-C_{i,k}&0&0 \end{array} \right)
\end{equation}
represent the immediate vaccination payoffs, respectively the payoffs per time step as a result of infection.  
The different components of the perceived cost, among others the market price of the vaccine and the expected side-effects conditional on the agent's beliefs, are included in \(C_{v,k}\). Besides, \(C_{i,k}\) captures the costs of infection, including medical treatment expenditures, absence from work or reduced personal well-being. Finally, agents discount the payoffs of future events using a discount rate \(r\), which is assumed to be constant.

Even though the actual infection probability  \(\lambda_{k}(t)\) is time dependent due to fluctuations in the incidence of the disease in the population, it is assumed to lie beyond the capabilities of any individual to simulate the entire social network for an accurate prediction of its evolution. Instead, each susceptible agent makes a point estimation \(\hat{\lambda}_{k}\) and assumes it to be constant during the forward time-horizon \(T\):\footnote{The heuristic approach for the calculation is justified on the basis of bounded rationality, given the outbreak characteristics of the disease. Especially, the following comes into play: While the disease percolates in the population, so does the knowledge about the disease. An agent is informed about the fact that a disease is spreading in the population as soon as any of the neighbours are infected, but cannot derive probabilities regarding spreading rate and severity. Given bounded rationality, the share of infected neighbours is the heuristic basis from which an agent derives the probability of infection. }
\begin{equation}\label{eq:10}
 	\hat{\lambda}_{k}=\hat{\beta} \cdot \frac{n_{k}(t)}{n_{k,T}}=\beta \cdot \frac{n_{k}(t)}{n_{k,T}}, 
\end{equation}
where \(n_{k,T}\) corresponds to the agent's total number of neighbours and \(\hat{\beta}\) being an estimated probability of infection, based on knowledge of historical cases. Given the characteristics of the disease, the estimation of \(\hat{\beta}\) is assumed to fit the actual \(\beta\), thus \(\hat{\beta}=\beta\). The hypothesis of making a point estimation that is constant during the forward time-horizon, amounts to treating the infection dynamics as a stationary Markov chain at the agent level:
\begin{equation}\label{eq:11}
	 \mathbf{x}_k(t+1) = \hat{\mathbf{Q}}_k \cdot \mathbf{x}_k(t),
\end{equation}
with:
\begin{equation}\label{eq:12}
	 \hat{\mathbf{Q}}_k = 
	 \left (\begin{array}{cccc} 1-\hat{\lambda}_{k}&0&0&0 \\
	 	\hat{\lambda}_{k}&1-\gamma_{k}&0&0 \\
		0&\gamma_{k}&1&0 \\
		0&0&0&1 \\
	  \end{array} \right)
\end{equation}
Given that the evolution of a stationary Markov chain is independent of any absolute time reference, without loss of generality \eqref{eq:7} can be rewritten using \(t = 0\). Employing \eqref{eq:11} and \eqref{eq:12}:
\begin{equation}\label{eq:13}
	U_k(\mathbf{x}_k(0), T) = \mathbf{f}_k(0) \cdot \mathbf{x}_k(0) + \sum_{t=1}^{T} {\mathbf{f}_k(t) \cdot   \left(\frac{ \hat{\mathbf{Q}}_k}{1+r}\right)^t \cdot \mathbf{x}_k(0) }
\end{equation}
In order to compute the power \({\hat{\mathbf{Q}}_k}^t\), the matrix can be diagonalized:
\begin{equation}\label{eq:14}
	\hat{\mathbf{Q}}_k=\hat{\mathbf{R}}_{k}\hat{\mathbf{\Lambda}}_{k}\hat{\mathbf{R}}^{-1}_{k}
\end{equation}
And \eqref{eq:13} can be rewritten as follows:
\begin{equation}\label{eq:15}
	U_k(\mathbf{x}_k(0), T)= \left[ \mathbf{f}_k(0) + \mathbf{f}_k(t) \cdot \hat{\mathbf{R}}_{k} \cdot \sum_{t=1}^{T} { \left(\frac{ \hat{\mathbf{\Lambda}}_{k}}{1+r}\right)^t \cdot \hat{\mathbf{R}}^{-1}_{k}} \right] \cdot \mathbf{x}_k(0)
\end{equation}
Finally, performing the required computations are obtained: 
\begin{equation}\label{eq:16}
	U_k(\mathbf{x}_k(0), T)=-p_{vacc} \cdot C_{v,k} - (1-p_{vacc}) \cdot C_{notv,k}
\end{equation}
where: 
\begin{equation}\label{eq:17}
	C_{notv,k}=C_{i,k} \cdot \left( \frac{\hat{\lambda}_{k}}{\gamma_{k}-\hat{\lambda}_{k}} \right) \cdot \left[\sum_{t = 1}^{T} \left(\frac{1-\hat{\lambda}_{k}}{1+r}\right)^t - \sum_{t = 1}^{T}\left(\frac{1-\gamma_k}{1+r}\right)^t\right]
\end{equation}
Equation \eqref{eq:16} is linear in \(p_{vacc}\), so it has only one global maximum which depends on the relative cost of each decision. In particular, the preferred strategies are the following:
\begin{equation}\label{eq:18}
	\begin{array}
	{@{}lr@{}}
        \multirow{p_{vacc}=0,} & \text{for }C_{v,k}>C_{notv,k} \\
        {p_{vacc}=1,} & \text{for }C_{notv,k}>C_{v,k} \\
        {p_{vacc}\in(0,1),} & \text{for }C_{v,k}=C_{notv,k} \\
    \end{array}
\end{equation}
Thus, agents follow a pure strategy for almost all values of \(C_{notv,k}\). Following equation \eqref{eq:18}, it becomes clear that \textit{ceteris paribus} a different vaccination strategy will be chosen depending on an agent's beliefs, manifested through different relative values for \(C_{v,k}\) and \(C_{i,k}\). In particular, it is expected that individuals skeptical towards vaccines will preferentially decide not to vaccinate for a given \(\hat{\lambda}_{k}\) and \(T\), as they consider the costs to be higher than what individuals who believe in the effectiveness of vaccines do.

%--------------------
\subsection{Network structure} 
The hierarchical configuration model in \cite{Stegehuis2016} provides an orientation for the model which is employed in this thesis. Adopting the two belief-groups, these are identified as sub-communities of the whole population. Each group is assumed to have a close intra-connection and a looser inter-connection. A small-world model is employed by formulating Watts-Strogatz networks \cite{watts1998} for every group, which are then connected as outlined below. 

Each community \(G\in{\{T,S\}}\) is a subset of the whole population \(N\), \(G\subset{N}\), with T representing 'trusters' and S representing 'skepticals'. Furthermore, 
\begin{equation}\label{eq:19}
\(g\colon \mathbb{N} \rightarrow{\{1,2\}}, 
\begin{align*}
g(i)\mapsto \left\{
\begin{array}{ll}	1, & i\textrm{ in group }T \\
	2, &  i\textrm{ in group }S \\
\end{array} \right\) 
\end{align*}
\end{equation}
indicates community-membership for an individual agent \(i\in{N}\).
The groups consist of a total of \(n_{G}\) members, according to \(n_{G}=\sum_{i\in{N}}p_{G}(i)=p_{G}(i)*n\). With \(n={\[\|N\|}\) being the number of nodes in the total population \(N\). Furthermore, \(p_{G}(i)\) defines the probabilistic group allocation for a node \(i\) to be assigned to group \(m\in{\{1,2\}}\), such that 
\begin{equation}\label{eq:20} 
\begin{align*}
\(p_{G}(i)=\left\{
\begin{array}{ll}	p_{1}, & i\textrm{ assigned to }T \\
	1-p_{1}=\colon p_{2}, &  i\textrm{ assigned to  }S \\
\end{array} \right\), p_{1,2}\in{[0,1]}
\end{align*}
\end{equation}
and \(p_{G}(i)\) is independent of the individual agent \(i\). 

The Watts-Strogatz graph for every group \(G\subset{N}\) is then built by taking into account \(k(i)\), the number of nearest neighbours of \(i\) that \(i\) is connected to in a ring topology. Following, the network is adjusted by looping over the edges in each group, which are then rewired according to \(p_{rew}\in{(0,1)}\). 

Thereafter, the two graphs are combined by adding an additional fraction of the edges in both groups for any two members \(i,j\in{N},i\neq j,\) of different groups, requiring \(g(i)\neq g(j)\). The amount of edges \(e_{add}\) is the fraction according to 
\begin{equation}\label{eq:21}
e_{add}=a*e_{G}=a*\bigg(\sum_{i\in{T}}k(i) + \sum_{j\in{S}}k(j)\bigg),
\end{equation}
with \(a\in{(0,1)}\), and 
\begin{equation}\label{eq:22}
	e_{G}=(\sum_{i\in{T}}k(i) + \sum_{j\in{S}}k(j)),
\end{equation} 
the total of edges in both groups. Any two members of different groups are then randomly connected until the amount of added connections reaches \(e_{add}\).  

%-----------------------------------------------------------------------------------------------------------------------------
%-----------------------------------------------------------------------------------------------------------------------------
\section{Initial Setup and Baseline Parameters}

The model described in the previous section contains a list of free parameters, whose baseline values are summarised in Table~\ref{tab:Table1} below and are used in all simulations unless stated otherwise.

\begin{table}[htbp]
        \centering
        \begin{tabular}{|c|c|c|}
        \hline
                Parameter    &    Value       \\
         \hline
                 \(r\)       &    0.01        \\
	\hline
                 \(T\)       &    10 days        \\
        \hline
                 \(\beta\)   &    0.05 day\(^{-1}\)        \\
        \hline
                 \(\gamma\)   &    0.05  day\(^{-1}\)      \\
        \hline
                 \(C_{i,T}\) = \(C_{i,S}\) &    1.0    \\
        \hline
                 \(C_{v,T}\)  &    0.01       \\
        \hline
		 \(C_{v,S}\)  &    0.05       \\
        \hline
		 \(k\)  &    8      	      \\
        \hline
		 \(\alpha\)  &    0.3         \\
        \hline
		 \(p_{rewiring}\)  &    0.2   \\
        \hline
        \end{tabular}
        \caption{Baseline values for the free parameters of the epidemic model}
        \label{tab:Table1}
    \end{table}

With respect to the parameters affecting each agent's decision process, the value of \(\gamma\) is specified assuming that a seasonal infectious disease would take an average of 20 days to get recovered from, and \(T\) is chosen as 1/2 of this time frame. For the current implementation of the model, no dependency of \(\gamma\) on the agent state was included, so that \(\forall k : \gamma_{k} = \gamma\). Given that the decision process is governed by the relative cost of vaccination to infection, the latter is fixed at a reference value of 1.0 for both groups and only \(C_v\) was set to reflect their different subjective costs. Finally, \(\beta\) was obtained from numerical experiments matching the expected dynamics for a fully connected graph, corresponding to a completely mixed population.

The parameters describing the network structure are set to describe a community of citizens in a typical urban environment. In this regard, a value of \(k = 8\) is chosen for the number of nearest neighbours in both groups of affiliation as well as a fraction \(\alpha = 0.3\) for the proportion of links between the two belief communities, in order to reflect differences in interpersonal affinity. The group population frequency \(q\) was set to 0.5 as a baseline in order to have an unbiased reference from which derive the sensitivity of the model output to variations in this parameter.

%-----------------------------------------------------------------------------------------------------------------------------
%-----------------------------------------------------------------------------------------------------------------------------

%------------------------------
%   IMPLEMENTATION
%------------------------------

\section{Implementation}

All our calculations are carried out in Python. More specifically we used $networkx$ for creating the network, $numpy$ for calculations and $matplotlib$ to visualize the results.

The code is split up in three files. $main.py$ forms the core of the simulation and is the only file that should be executed. Also, all variables that characterize the simulation and can be altered in $main.py$ to obtain different results.

\subsection{Creating the network}
By executing $main.py$ an object of type $SmallWorldNetwork$ (defined in\\ $small\_world\_network.py$) is created. The parameters characterizing the network are $n$, $group\_percentages$, $k$, $change\_edge\_percentage$ and $alpha$ defined at the beginning of $main.py$.

$n$ defines the total number of nodes in the network. This number is then split up into different groups according to $group\_percentages$. For example, if $n=100$ and $group\_percentages = [0.2, 0.8]$ two groups are created. One with 20 nodes and one with 80 nodes. For each of these groups a Watts-Strogatz model is created using $k$ and $change\_edge\_percentage$. In a Watts-Strogatz model each node is connected to its $k$ nearest neighbors. Then each edge is rewired with a probability of  $change\_edge\_percentage$.

After creating a model for each group, the individual groups are loosely connected with a percentage $alpha$. In other words $alpha * n$ nodes are connected to both groups while all other nodes only share edges with nodes of the same group.

Thus, it is more likely to be connected to members of your own group but at the same time groups are never completely isolated from each other. 

In a last step the created network is populated with agents. Hence, for each node an agent with the respective group type is created and stored in a list. The initial health status (susceptible, infected or vaccinated) is derived from rates defined in $lim\_init\_infected$ and $lim\_init\_vacci$. Furthermore, each agent has a certain age that is derived from a normal distribution using $age\_mu$ and $age\_simga$.

Age is only included for possible extensions of the model in the future. It is not being used in our model.


\subsection{Simulating the agents' behaviour}
Almost all functions in $main.py$ are responsible for visualizing the results.
The simulation itself almost entirely takes place in the $Agent$ class defined in $agent.py$.


In our case every iteration represents a day in the agents' life. The number of days to be simulated is defined by the variable $frames$.
Hence, every day the main file loops over all agents in the network and thus calls the $run$ function exactly once (per day). Starting from the $run$ function a number of other functions is called that determine whether the agent is getting infected, recovers or vaccinates. For the decision of vaccination the $act$ function gathers the different values needed in equation \eqref{eq:16} to ultimately decide whether to vaccinate or not (equations \eqref{eq:17}).


%------------------------------
%   RESULTS AND DISCUSSION
%------------------------------
\section{Simulation Results and Discussion}


%------------------------------
%   SUMMARY AND OUTLOOK
%------------------------------

\section{Summary and Outlook}






\bibliographystyle{agsm}
\bibliography{/Users/JuliusSiebenaller/Desktop/Vacci-Nation/Report/References.bib}
\clearpage

\end{document}  



 
